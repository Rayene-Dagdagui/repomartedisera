<div class="container">
  <div class="mb-4">
    <h1 class="title">Esploratore Meteo</h1>
    <div class="subtitle">Cerca una città e mostra il meteo attuale (Open-Meteo, gratuito).</div>
  </div>

  <div class="grid">
    <div>
      <label class="small">Città</label>
      <input placeholder="es. Roma" [(ngModel)]="searchTitle" />
    </div>

    <div class="full" style="display:flex;gap:8px;justify-content:flex-end;">
      <button class="primary" (click)="fetchWeather()" [disabled]="loading">{{ loading ? 'Caricamento...' : 'Mostra meteo' }}</button>
      <button (click)="mockMode = !mockMode">Modalità Mock</button>
      <button (click)="reset()">Azzera</button>
    </div>
  </div>

  <div *ngIf="error" class="card" style="margin-top:12px;color:#b91c1c;">Errore: {{ error }}</div>

  <div *ngIf="results.length > 0" style="margin-top:12px;display:flex;flex-direction:column;gap:12px;">
    <div *ngFor="let r of results" class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="font-weight:700;">{{ r.city }} {{ r.country ? '(' + r.country + ')' : '' }}</div>
          <div class="small">Ora: {{ r.time }}</div>
        </div>
        <div style="text-align:right;">
          <div style="font-size:20px;font-weight:700;">{{ weatherCodeToEmoji(r.weathercode) }} {{ r.temperature }}°C</div>
          <div class="small">Vento: {{ r.windspeed }} m/s</div>
        </div>
      </div>

      <div *ngIf="r.hourlyForecast && r.hourlyForecast.length > 0" style="margin-top:10px;">
        <div style="font-weight:600;margin-bottom:6px;">Previsioni orarie (prime 24 ore):</div>
        <div class="hour-grid">
          <div *ngFor="let h of r.hourlyForecast">
            <div>{{ h.time | slice:11:16 }}</div>
            <div style="font-weight:600">{{ h.temperature }}°C</div>
            <div class="small">{{ h.windspeed }} m/s</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="results.length === 0 && !loading" class="small" style="margin-top:12px;">Nessun risultato — inserisci una città e premi "Mostra meteo".</div>

</div>

